<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>System Inspector â€” Enhanced</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --accent:#4f46e5; --accent-2:#06b6d4; --glass: rgba(255,255,255,0.04);
      --radius:12px; --glass-2: rgba(255,255,255,0.02);
      --text:#e6eef8; --soft:#cbd5e1;
    }
    [data-theme="light"]{ --bg:#f3f6fb; --card:#fff; --muted:#475569; --accent:#2563eb; --accent-2:#06b6d4; --glass: rgba(0,0,0,0.03); --glass-2: rgba(0,0,0,0.02); --text:#0b1220; --soft:#334155 }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;color:var(--text);background:linear-gradient(180deg,var(--bg),rgba(0,0,0,0.12));padding:20px}

    .app{max-width:1200px;margin:0 auto;display:grid;grid-template-columns:260px 1fr;gap:18px;align-items:start}

    /* Sidebar */
    .sidebar{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 6px 18px rgba(2,6,23,0.6);height:fit-content}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:700;color:white}
    h1{font-size:16px;margin:0}
    p.lead{margin:6px 0 12px;color:var(--muted);font-size:13px}

    .controls{display:flex;flex-direction:column;gap:8px}
    .btn{background:transparent;border:1px solid var(--glass);color:var(--text);padding:8px 10px;border-radius:8px;cursor:pointer;font-weight:600}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));border:none;color:white}
    .row{display:flex;gap:8px}
    .metric{padding:10px;border-radius:8px;background:linear-gradient(180deg,var(--glass),var(--glass-2));border:1px solid rgba(255,255,255,0.03);}
    .small{font-size:12px;color:var(--muted)}

    /* Main */
    .main{display:flex;flex-direction:column;gap:14px}
    .topbar{display:flex;justify-content:space-between;align-items:center;gap:10px}
    .search{flex:1}
    .search input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--glass);background:transparent;color:var(--text)}

    .cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px}
    .card{background:var(--card);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 6px 18px rgba(2,6,23,0.45);min-height:80px}
    .card h3{margin:0 0 8px;font-size:13px}
    .kv{display:flex;justify-content:space-between;align-items:center}
    .kv .k{color:var(--muted);font-size:12px}
    .kv .v{font-weight:600}

    .sections{display:grid;grid-template-columns:1fr;gap:12px}
    .section{background:linear-gradient(180deg,var(--glass),transparent);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .section .header{display:flex;justify-content:space-between;align-items:center;cursor:pointer}
    .section .content{margin-top:12px;display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:10px}

    .detail{background:rgba(255,255,255,0.02);padding:10px;border-radius:10px}
    .detail .label{font-size:12px;color:var(--muted)}
    .detail .value{font-weight:600;margin-top:6px}

    .footer{text-align:center;color:var(--muted);font-size:13px}

    /* small screens */
    @media (max-width:900px){.app{grid-template-columns:1fr}.sidebar{order:2}.main{order:1}}

    /* subtle animations */
    .fade{animation:fadeIn .5s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
  </style>
</head>
<body>
  <div class="app" data-theme="dark">
    <aside class="sidebar fade" aria-label="controls">
      <div class="brand"><div class="logo">SI</div><div><h1>System Inspector</h1><p class="lead">Enhanced diagnostics & tips</p></div></div>

      <div style="height:8px"></div>
      <div class="controls">
        <button class="btn primary" id="refreshBtn">ðŸ”„ Refresh</button>
        <div class="row">
          <button class="btn" id="exportJson">ðŸ“¥ Export JSON</button>
          <button class="btn" id="copyBtn">ðŸ“‹ Copy</button>
        </div>
        <div class="row">
          <button class="btn" id="themeToggle">ðŸŒ™ Theme</button>
          <button class="btn" id="runBench">ðŸš€ Run Benchmark</button>
        </div>
        <div style="height:10px"></div>
        <div class="metric"><div class="small">Last updated</div><div id="lastUpdated" style="font-weight:700;margin-top:6px">â€”</div></div>
        <div class="metric" style="margin-top:8px"><div class="small">Quick Actions</div>
          <div style="display:flex;gap:8px;margin-top:8px"><button class="btn" id="pingTest">Ping Test</button><button class="btn" id="clearCache">Clear Storage</button></div>
        </div>
      </div>
    </aside>

    <main class="main">
      <div class="topbar">
        <div class="search"><input id="searchInput" placeholder="Search properties (e.g. GPU, Battery, WebGL)..." /></div>
        <div style="display:flex;gap:8px;align-items:center">
          <div class="card" style="min-width:220px;padding:10px"><div class="kv"><div><div class="small">Browser</div><div id="browserBrief" class="v">â€”</div></div><div style="text-align:right"><div class="small">Network</div><div id="connBrief" class="v">â€”</div></div></div></div>
          <div class="card" style="min-width:140px;padding:10px"><div class="small">CPU Threads</div><div id="cpuThreads" style="font-weight:700">â€”</div></div>
        </div>
      </div>

      <div class="cards">
        <div class="card fade"><h3>Quick Overview</h3><div class="kv"><div><div class="small">Device</div><div id="deviceBrief" class="v">â€”</div></div><div><div class="small">Screen</div><div id="screenBrief" class="v">â€”</div></div></div></div>
        <div class="card fade"><h3>Performance</h3><div class="kv"><div><div class="small">Estimated</div><div id="perfBrief" class="v">â€”</div></div><div><div class="small">Memory</div><div id="memBrief" class="v">â€”</div></div></div></div>
        <div class="card fade"><h3>Power</h3><div class="kv"><div><div class="small">Battery</div><div id="batteryBrief" class="v">â€”</div></div><div><div class="small">Charging</div><div id="chargingBrief" class="v">â€”</div></div></div></div>
      </div>

      <div class="sections">
        <section class="section fade" id="section-browser">
          <div class="header"><strong>Browser & Platform</strong><div class="small">Click to collapse</div></div>
          <div class="content" id="content-browser"></div>
        </section>

        <section class="section fade" id="section-hardware">
          <div class="header"><strong>Hardware & Memory</strong><div class="small">CPU / RAM / Threads</div></div>
          <div class="content" id="content-hardware"></div>
        </section>

        <section class="section fade" id="section-display">
          <div class="header"><strong>Display & Graphics</strong><div class="small">WebGL / GPU info</div></div>
          <div class="content" id="content-display"></div>
        </section>

        <section class="section fade" id="section-network">
          <div class="header"><strong>Network & Resources</strong><div class="small">Connection / Timing / Ping</div></div>
          <div class="content" id="content-network"></div>
        </section>

        <section class="section fade" id="section-media">
          <div class="header"><strong>Media & Devices</strong><div class="small">Cameras / Microphones</div></div>
          <div class="content" id="content-media"></div>
        </section>

        <section class="section fade" id="section-features">
          <div class="header"><strong>Features & Capabilities</strong><div class="small">APIs supported</div></div>
          <div class="content" id="content-features"></div>
        </section>
      </div>

      <div class="footer">System Inspector â€” enhanced Â· <span id="timestamp">â€”</span></div>
    </main>
  </div>

  <script>
  (function(){
    // Utility helpers
    const $ = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));
    const now = () => new Date().toLocaleString();

    // Scoped update helpers to avoid collision
    function makeDetail(label, value){
      return `<div class="detail"><div class="label">${label}</div><div class="value">${value}</div></div>`;
    }

    // Safe get with fallback
    function safe(fn, fallback){try{return fn()}catch(e){return fallback}}

    // Browser parsing once
    function parseBrowser(){
      const ua = navigator.userAgent || '';
      let name = 'Unknown';
      if(/Edg\//i.test(ua)) name='Edge';
      else if(/OPR|Opera/i.test(ua)) name='Opera';
      else if(/Chrome\//i.test(ua)) name='Chrome';
      else if(/Firefox\//i.test(ua)) name='Firefox';
      else if(/Safari\//i.test(ua)) name='Safari';
      const ver = (ua.match(/(Edg|Chrome|Firefox|Version|Safari|OPR|MSIE|rv:)(?:\/|:| )(\d+(?:\.\d+)?)/i) || [,'', '']).pop();
      return {name, version: ver||'' , ua};
    }

    // Async collectors
    async function collectBrowser(){
      const b = parseBrowser();
      const arr = [];
      arr.push({label:'Browser', value: `${b.name} ${b.version}`});
      arr.push({label:'User Agent', value: b.ua});
      arr.push({label:'Language', value: navigator.language || 'â€”'});
      arr.push({label:'Cookies Enabled', value: navigator.cookieEnabled ? 'Yes' : 'No'});
      arr.push({label:'Do Not Track', value: navigator.doNotTrack || 'unspecified'});
      if(navigator.languages) arr.push({label:'Languages', value: navigator.languages.join(', ')});
      return arr;
    }

    async function collectSystem(){
      const ua = navigator.userAgent || '';
      let os='Unknown';
      if(/Windows NT 10.0/.test(ua)) os='Windows 10/11';
      else if(/Windows NT 6.3/.test(ua)) os='Windows 8.1';
      else if(/Mac OS X|macOS/.test(ua)) os='macOS';
      else if(/Android/.test(ua)) os='Android';
      else if(/iPhone|iPad|iPod/.test(ua)) os='iOS';
      else if(/Linux/.test(ua)) os='Linux';

      const details = [];
      details.push({label:'Operating System', value: os});
      details.push({label:'Platform', value: navigator.platform || 'â€”'});

      const isMobile = /Mobi|Android|iPhone|iPad/i.test(ua);
      details.push({label:'Device Type', value: isMobile ? 'Mobile' : 'Desktop'});

      const arch = /x86_64|Win64|x64|amd64/.test(ua) ? '64-bit' : '32-bit';
      details.push({label:'Architecture', value: arch});
      details.push({label:'Date & Time', value: now()});
      details.push({label:'Timezone', value: Intl.DateTimeFormat().resolvedOptions().timeZone || 'â€”'});

      if('hardwareConcurrency' in navigator) details.push({label:'CPU Threads', value: navigator.hardwareConcurrency});
      if('deviceMemory' in navigator) details.push({label:'Device Memory', value: navigator.deviceMemory + ' GB'});

      details.push({label:'Dark Mode', value: window.matchMedia('(prefers-color-scheme: dark)').matches ? 'Enabled' : 'Disabled'});
      details.push({label:'Reduced Motion', value: window.matchMedia('(prefers-reduced-motion: reduce)').matches ? 'Enabled' : 'Disabled'});

      // Estimated performance
      const cpuPerf = (navigator.hardwareConcurrency || 2) > 4 ? 'High' : 'Standard';
      const memPerf = (navigator.deviceMemory || 4) > 4 ? 'High' : 'Standard';
      details.push({label:'Estimated Performance', value:`${cpuPerf} (${memPerf} memory)`});
      return details;
    }

    async function collectDisplay(){
      const arr=[];
      arr.push({label:'Screen Resolution', value:`${window.screen.width}x${window.screen.height}`});
      arr.push({label:'Window Size', value:`${window.innerWidth}x${window.innerHeight}`});
      arr.push({label:'Pixel Ratio', value: window.devicePixelRatio});

      // WebGL/WebGL2/WebGPU detection and GPU info
      try{
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        const gl2 = canvas.getContext('webgl2');
        if(gl){
          const dbg = gl.getExtension('WEBGL_debug_renderer_info');
          if(dbg){
            arr.push({label:'GPU Vendor', value: gl.getParameter(dbg.UNMASKED_VENDOR_WEBGL)});
            arr.push({label:'GPU Renderer', value: gl.getParameter(dbg.UNMASKED_RENDERER_WEBGL)});
          } else {
            arr.push({label:'GPU', value:'WebGL available (details restricted)'});
          }
          arr.push({label:'WebGL Version', value: gl.getParameter(gl.VERSION)});
          arr.push({label:'Max Texture Size', value: gl.getParameter(gl.MAX_TEXTURE_SIZE) + ' px'});
        } else if(gl2){
          arr.push({label:'WebGL2', value: 'Supported'});
        } else {
          arr.push({label:'WebGL', value: 'Not supported'});
        }

        // WebGPU detection (experimental)
        if('gpu' in navigator){
          try{
            arr.push({label:'WebGPU', value:'Available (experimental)'});
          }catch(e){arr.push({label:'WebGPU', value:'Detected but cannot query'})}
        } else {
          arr.push({label:'WebGPU', value:'Not detected'});
        }
      }catch(e){arr.push({label:'GPU Information', value:'Could not detect'})}

      return arr;
    }

    async function collectNetwork(){
      const arr=[];
      const conn = navigator.connection || {};
      arr.push({label:'Connection Type', value: conn.effectiveType || 'Unknown'});
      arr.push({label:'Downlink', value: conn.downlink ? conn.downlink + ' Mbps' : 'â€”'});
      arr.push({label:'RTT', value: conn.rtt ? conn.rtt + ' ms' : 'â€”'});
      arr.push({label:'Save-Data', value: conn.saveData ? 'Enabled' : 'Disabled'});
      arr.push({label:'Online', value: navigator.onLine ? 'Online' : 'Offline'});

      // Resource timing summary
      try{
        const resources = performance.getEntriesByType('resource') || [];
        const total = resources.reduce((s,r)=>s+(r.transferSize||0),0);
        arr.push({label:'Resources Loaded', value:`${resources.length} (${Math.round(total/1024)} KB)`});
      }catch(e){/*ignore*/}

      // network quality placeholder updated by listener
      if(conn && typeof conn.addEventListener === 'function'){
        const update = () => {
          const el = document.querySelector('[data-network-quality]');
          if(el) el.textContent = `${conn.effectiveType || 'unknown'} ${conn.downlink?`(${conn.downlink} Mbps)`:''}`;
        };
        conn.addEventListener('change', update);
        arr.push({label:'Network Quality', value:`<span data-network-quality>${conn.effectiveType || 'Monitoring...'}</span>`});
      }

      return arr;
    }

    async function collectStorageAndPower(){
      const arr=[];
      // Performance timings
      try{
        const nav = performance.getEntriesByType('navigation')[0] || performance.timing || null;
        if(nav){
          const load = (nav.loadEventEnd && nav.startTime) ? Math.max(0,Math.round(nav.loadEventEnd - nav.startTime)) : 'â€”';
          arr.push({label:'Page Load Time', value: typeof load === 'number' ? load + ' ms' : 'â€”'});
        }
      }catch(e){}

      // Storage estimate
      if(navigator.storage && navigator.storage.estimate){
        arr.push({label:'Storage Usage', value:'<span data-storage-usage>Calculating...</span>'});
        navigator.storage.estimate().then(est=>{
          const used = Math.round((est.usage||0)/(1024*1024));
          const quota = Math.round((est.quota||0)/(1024*1024));
          const percent = quota?Math.round((used/quota)*100):0;
          const el = document.querySelector('[data-storage-usage]');
          if(el) el.textContent = `${used} MB / ${quota} MB (${percent}%)`;
        }).catch(()=>{});
      }

      // Battery
      if('getBattery' in navigator){
        arr.push({label:'Battery', value:'<span data-battery>Checking...</span>'});
        navigator.getBattery().then(bat=>{
          const update = ()=>{
            const el = document.querySelector('[data-battery]');
            if(!el) return;
            el.textContent = `${Math.round(bat.level*100)}% ${bat.charging? '(Charging)':''}`;
          };
          bat.addEventListener('levelchange', update);
          bat.addEventListener('chargingchange', update);
          update();
        }).catch(()=>{
          const el = document.querySelector('[data-battery]'); if(el) el.textContent='Unavailable';
        });
      } else {
        arr.push({label:'Battery', value:'Not supported'});
      }

      return arr;
    }

    async function collectMedia(){
      const arr=[];
      arr.push({label:'Media Support', value: ('mediaDevices' in navigator) ? 'Available' : 'Not available'});
      if(navigator.mediaDevices && navigator.mediaDevices.enumerateDevices){
        arr.push({label:'Media Devices', value: '<span data-media>Detecting...</span>'});
        navigator.mediaDevices.enumerateDevices().then(devs=>{
          const cams = devs.filter(d=>d.kind==='videoinput').length;
          const mics = devs.filter(d=>d.kind==='audioinput').length;
          const outs = devs.filter(d=>d.kind==='audiooutput').length;
          const el = document.querySelector('[data-media]'); if(el) el.textContent = `Cameras: ${cams}, Microphones: ${mics}, Speakers: ${outs}`;
        }).catch(err=>{const el=document.querySelector('[data-media]'); if(el) el.textContent='Permission denied or none';});
      }
      return arr;
    }

    async function collectFeatures(){
      const feats = [
        ['Geolocation','geolocation' in navigator],
        ['Camera/Microphone','mediaDevices' in navigator],
        ['Web Bluetooth','bluetooth' in navigator],
        ['Vibration','vibrate' in navigator],
        ['Push Notifications','PushManager' in window],
        ['Speech Recognition','SpeechRecognition' in window || 'webkitSpeechRecognition' in window],
        ['Speech Synthesis','speechSynthesis' in window],
        ['Web Share','share' in navigator],
        ['Gamepad API','getGamepads' in navigator],
        ['Web Payments','PaymentRequest' in window],
        ['WebGL', !!document.createElement('canvas').getContext('webgl')],
        ['WebGL2', !!document.createElement('canvas').getContext('webgl2')],
        ['WebAssembly', typeof WebAssembly === 'object'],
        ['Service Workers','serviceWorker' in navigator],
        ['Web Workers', typeof Worker === 'function'],
        ['Clipboard API', navigator.clipboard && 'writeText' in navigator.clipboard]
      ];
      return feats.map(f=>({label:f[0], value: f[1] ? 'Supported' : 'Not Supported'}));
    }

    // Render helpers
    function renderSection(containerId, items){
      const el = document.getElementById(containerId);
      if(!el) return;
      el.innerHTML = items.map(i => makeDetail(i.label, i.value)).join('');
    }

    // summary updates
    function updateBriefs(){
      const b = parseBrowser();
      $('#browserBrief').textContent = `${b.name} ${b.version}`;
      $('#cpuThreads').textContent = navigator.hardwareConcurrency || 'â€”';
      $('#deviceBrief').textContent = `${/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)?'Mobile':'Desktop'} Â· ${navigator.platform||''}`;
      $('#screenBrief').textContent = `${window.screen.width}x${window.screen.height} @ ${window.devicePixelRatio}x`;
      $('#lastUpdated').textContent = now();
      $('#timestamp').textContent = now();

      // memory
      $('#memBrief').textContent = (navigator.deviceMemory ? navigator.deviceMemory + ' GB' : 'Unknown');

      // perf
      $('#perfBrief').textContent = (navigator.hardwareConcurrency && navigator.hardwareConcurrency > 4) ? 'High' : 'Standard';

      // battery quick
      const batteryEl = document.querySelector('[data-battery]');
      $('#batteryBrief').textContent = batteryEl ? batteryEl.textContent : 'â€”';
      $('#chargingBrief').textContent = batteryEl && batteryEl.textContent.includes('Charging')? 'Yes':'No';

      // network
      const conn = navigator.connection || {};
      $('#connBrief').textContent = `${(conn.effectiveType||'unknown').toUpperCase()} ${conn.downlink?`(${conn.downlink} Mbps)`:''}`;
    }

    // Ping test (simple fetch to a known endpoint)
    async function pingTest(url='https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png',count=4){
      const results=[];
      for(let i=0;i<count;i++){
        const t0 = performance.now();
        try{
          const resp = await fetch(url, {cache:'no-store', mode:'no-cors'});
          const t1 = performance.now();
          results.push(Math.round(t1-t0));
        }catch(e){
          // mode no-cors prevents reading response but timing still works in many browsers
          const t1 = performance.now(); results.push(Math.round(t1-t0));
        }
      }
      const avg = Math.round(results.reduce((a,b)=>a+b,0)/results.length);
      return {rtts:results, avg};
    }

    // Simple CPU benchmark: busy loop doing math
    async function runCpuBench(iterations=40){
      const results=[];
      for(let p=0;p<iterations;p++){
        const t0=performance.now();
        // small math workload
        let x=0;
        for(let i=0;i<200000;i++) x += Math.sqrt(i+Math.random());
        const t1 = performance.now();
        results.push(t1-t0);
        // yield to UI occasionally
        if(p%5===0) await new Promise(r=>setTimeout(r,20));
      }
      const avg = Math.round(results.reduce((a,b)=>a+b,0)/results.length);
      return {samples:results, avg};
    }

    // Export utilities
    function gatherAll(){
      return Promise.all([collectBrowser(), collectSystem(), collectDisplay(), collectNetwork(), collectStorageAndPower(), collectMedia(), collectFeatures()])
        .then(([b,s,d,n,sp,m,f])=>({browser:b, system:s, display:d, network:n, storageAndPower:sp, media:m, features:f, timestamp: new Date().toISOString()}));
    }

    async function refreshAll(){
      // Collect and render
      const [b,s,d,n,sp,m,f] = await Promise.all([collectBrowser(), collectSystem(), collectDisplay(), collectNetwork(), collectStorageAndPower(), collectMedia(), collectFeatures()]);
      renderSection('content-browser', b);
      renderSection('content-hardware', s);
      renderSection('content-display', d);
      renderSection('content-network', n.concat(sp));
      renderSection('content-media', m);
      renderSection('content-features', f);
      updateBriefs();
    }

    // Event wiring
    $('#refreshBtn').addEventListener('click', ()=>{refreshAll();});

    let theme = 'dark';
    function applyTheme(){
      document.querySelector('.app').setAttribute('data-theme', theme==='dark'?'dark':'light');
      $('#themeToggle').textContent = theme==='dark' ? 'ðŸŒ™ Theme' : 'â˜€ï¸ Theme';
    }
    $('#themeToggle').addEventListener('click', ()=>{theme = theme==='dark'?'light':'dark'; applyTheme();});

    $('#exportJson').addEventListener('click', async ()=>{
      const data = await gatherAll();
      const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='system-inspector.json'; a.click();
      URL.revokeObjectURL(url);
    });

    $('#copyBtn').addEventListener('click', async ()=>{
      const data = await gatherAll();
      const text = JSON.stringify(data, null, 2);
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(text).then(()=>alert('Copied to clipboard')) .catch(()=>prompt('Copy the JSON below', text));
      } else {
        prompt('Copy the JSON below', text);
      }
    });

    $('#pingTest').addEventListener('click', async ()=>{
      const btn = $('#pingTest'); btn.textContent='Pinging...'; btn.disabled=true;
      try{
        const res = await pingTest();
        alert('Ping RTTs: ' + res.rtts.join(', ') + ' ms \\nAverage: ' + res.avg + ' ms');
      }catch(e){alert('Ping failed: '+ e.message)}
      btn.textContent='Ping Test'; btn.disabled=false;
    });

    $('#runBench').addEventListener('click', async ()=>{
      const btn = $('#runBench'); btn.textContent='Running...'; btn.disabled=true;
      const res = await runCpuBench(20);
      alert('CPU benchmark average: ' + Math.round(res.avg) + ' ms per batch');
      btn.textContent='ðŸš€ Run Benchmark'; btn.disabled=false;
    });

    $('#clearCache').addEventListener('click', ()=>{
      try{localStorage.clear(); sessionStorage.clear(); alert('Storage cleared (local/session)');}catch(e){alert('Could not clear storage')}
    });

    // Search filter
    $('#searchInput').addEventListener('input', (e)=>{
      const q = e.target.value.trim().toLowerCase();
      $$('.detail').forEach(d=>{
        const label = d.querySelector('.label').textContent.toLowerCase();
        const val = d.querySelector('.value').textContent.toLowerCase();
        d.style.display = (!q || label.includes(q) || val.includes(q)) ? '' : 'none';
      });
    });

    // Collapsible sections
    $$('.section .header').forEach(h=>{
      h.addEventListener('click', ()=>{
        const content = h.parentElement.querySelector('.content');
        content.style.display = content.style.display === 'none' ? '' : 'none';
      });
    });

    // Initial run
    applyTheme();
    refreshAll();

    // Update some brief values periodically
    setInterval(()=>{ updateBriefs(); }, 5000);
  })();
  </script>
</body>
</html>
